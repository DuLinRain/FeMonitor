!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.FeMonitor=n():e.FeMonitor=n()}(window,function(){return function(e){var n={};function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=n,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)o.d(t,r,function(n){return e[n]}.bind(null,r));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="",o(o.s=0)}([function(e,n,o){"use strict";function t(e,n){for(var o=0;o<n.length;o++){var t=n[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}o.r(n),o.d(n,"FeMonitor",function(){return r});var r=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e);var o=n.consolelog,t=void 0!==o&&o,r=n.consoleinfo,i=void 0!==r&&r,c=n.consoleerror,a=void 0===c||c,l=n.error,u=void 0===l||l,s=n.errormode,f=void 0===s?1:s,p=n.captureclick,d=void 0!==p&&p,v=n.capturemode,h=void 0===v?1:v,y=n.capturereportnum,m=void 0===y?1:y,g=n.unhandledrejection,w=void 0===g||g,k=n.network,b=void 0===k||k,j=n.performance,E=void 0===j||j;this.consolelog=t,this.consoleinfo=i,this.consoleerror=a,this.error=u,this.errormode=f,this.captureclick=d,this.capturemode=h,this.capturereportnum=m,this.performance=E,this.unhandledrejection=w,this.network=b,this.start()}var n,o,r;return n=e,(o=[{key:"start",value:function(){this.initConsole(),this.initError(),this.initCaptureClick(),this.initUnhandledPromiseRejection(),this.initNetWork(),this.initPerference()}},{key:"initConsole",value:function(){var e=this;e.consolelog&&e.initConsoleLog(),e.consoleinfo&&e.initConsoleInfo(),e.consoleerror&&e.initConsoleError()}},{key:"initConsoleLog",value:function(){var e={apply:function(e,n,o){return alert("我要进行上报console.log"),Reflect.apply.apply(Reflect,arguments)}};console.log=new Proxy(console.log,e)}},{key:"initConsoleInfo",value:function(){var e={apply:function(e,n,o){return alert("我要进行上报console.info"),Reflect.apply.apply(Reflect,arguments)}};console.info=new Proxy(console.info,e)}},{key:"initConsoleError",value:function(){var e={apply:function(e,n,o){return alert("我要进行上报console.error"),Reflect.apply.apply(Reflect,arguments)}};console.error=new Proxy(console.error,e)}},{key:"initError",value:function(){var e=this;if(e.error)if(1===e.errormode){var n=window.onerror;window.onerror=function(e,o,t,r,i){console.log(e,o,t,r,i),n&&n()}}else window.addEventListener("error",function(n){console.log(n);var o=n.message,t=n.filename,r=n.lineno,i=n.colno,c=n.error;console.log(o,t,r,i,c),e.reportCaptureImage()})}},{key:"reportCaptureImage",value:function(){var e=this;if(e.captureclick){e.capturereportnum=e.capturereportnum>10?10:e.capturereportnum,e.capturereportnum=e.capturereportnum<=0?1:e.capturereportnum;var n=e.capturedDoms.slice(0,e.capturereportnum)||[];(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new Promise(function(n,o){var t=document.createElement("script");t.type="text/javascript",t.src=e,document.querySelector("head").appendChild(t),t.onload=function(){n(window.html2canvas)},t.onerror=function(){o("js加载失败")}})})("//unpkg.com/html2canvas@1.0.0-alpha.12/dist/html2canvas.min.js").then(function(e){if(n.length&&(e||window.html2canvas)){var o=!0,t=!1,r=void 0;try{for(var i,c=n[Symbol.iterator]();!(o=(i=c.next()).done);o=!0){e(i.value).then(function(e){var n=e.toDataURL("image/png");return console.log(n),n})}}catch(e){t=!0,r=e}finally{try{o||null==c.return||c.return()}finally{if(t)throw r}}}}).catch(function(e){console.log(e)})}}},{key:"initCaptureClick",value:function(){var e=this;e.captureclick&&(e.capturedDoms=[],window.addEventListener("click",function(n){var o=Array.from(n.path);if(o.pop(),o.pop(),e.capturedDoms.length>=10&&e.capturedDoms.pop(),1===e.capturemode)o[0];var t=1===e.capturemode?o[0]:o[o.length-1];e.capturedDoms.unshift(t)},!0))}},{key:"initUnhandledPromiseRejection",value:function(){this.unhandledrejection&&window.addEventListener("unhandledrejection",function(e){console.log(e)})}},{key:"initNetWork",value:function(){if(this.network&&window.XMLHttpRequest){var e=window.XMLHttpRequest,n=e.prototype.send,o=function(e){e&&e.currentTarget&&200!==e.currentTarget.status&&console.log(e)};if(e.prototype.send=function(){if(this.addEventListener)this.addEventListener("error",o),this.addEventListener("load",o),this.addEventListener("abort",o),this.addEventListener("close",o);else{var e=this.onreadystatechange;this.onreadystatechange=function(n){4===this.readyState&&o(n),e&&e.apply(this,arguments)}}return n.apply(this,arguments)},window.fetch){var t=window.fetch;window.fetch=function(){return t.apply(this,arguments).then(function(e){return e.ok||console.log(e),e}).catch(function(e){console.log(e)})}}}}},{key:"initPerference",value:function(){this.performance&&window.performance&&window.performance.getEntries()&&window.performance.getEntries().forEach(function(e){console.log(JSON.stringify(e))})}}])&&t(n.prototype,o),r&&t(n,r),e}()}])});