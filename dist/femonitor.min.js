!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.FeMonitor=n():e.FeMonitor=n()}(window,function(){return function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}t.r(n),t.d(n,"FeMonitor",function(){return r});var r=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e);var t=n.consolelog,o=void 0!==t&&t,r=n.consoleinfo,i=void 0!==r&&r,a=n.consoleerror,c=void 0===a||a,l=n.error,u=void 0===l||l,s=n.errormode,f=void 0===s?1:s,p=n.captureclick,d=void 0!==p&&p,v=n.capturemode,h=void 0===v?1:v,y=n.capturereportnum,m=void 0===y?1:y,w=n.unhandledrejection,g=void 0===w||w,k=n.network,b=void 0===k||k,j=n.performance,E=void 0===j||j;this.consolelog=o,this.consoleinfo=i,this.consoleerror=c,this.error=u,this.errormode=f,this.captureclick=d,this.capturemode=h,this.capturereportnum=m,this.performance=E,this.unhandledrejection=g,this.network=b,this.start()}var n,t,r;return n=e,(t=[{key:"start",value:function(){this.initConsole(),this.initError(),this.initCaptureClick(),this.initUnhandledPromiseRejection(),this.initNetWork(),this.initPerference()}},{key:"initConsole",value:function(){var e=this;e.consolelog&&e.initConsoleLog(),e.consoleinfo&&e.initConsoleInfo(),e.consoleerror&&e.initConsoleError()}},{key:"initConsoleLog",value:function(){var e={apply:function(e,n,t){return alert("我要进行上报console.log"),Reflect.apply.apply(Reflect,arguments)}};console.log=new Proxy(console.log,e)}},{key:"initConsoleInfo",value:function(){var e={apply:function(e,n,t){return alert("我要进行上报console.info"),Reflect.apply.apply(Reflect,arguments)}};console.info=new Proxy(console.info,e)}},{key:"initConsoleError",value:function(){var e={apply:function(e,n,t){return alert("我要进行上报console.error"),Reflect.apply.apply(Reflect,arguments)}};console.error=new Proxy(console.error,e)}},{key:"initError",value:function(){var e=this;if(e.error)if(1===e.errormode){var n=window.onerror;window.onerror=function(e,t,o,r,i){console.log(e,t,o,r,i),n&&n()}}else window.addEventListener("error",function(n){console.log(n);var t=n.message,o=n.filename,r=n.lineno,i=n.colno,a=n.error;console.log(t,o,r,i,a),e.reportCaptureImage()})}},{key:"reportCaptureImage",value:function(){var e=this;if(e.captureclick){e.capturereportnum=e.capturereportnum>10?10:e.capturereportnum,e.capturereportnum=e.capturereportnum<=0?1:e.capturereportnum;var n=e.capturedDoms.slice(0,e.capturereportnum)||[];if(window.html2canvas){if(n.length&&(html2canvas||window.html2canvas)){var t=!0,o=!1,r=void 0;try{for(var i,a=n[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var c=i.value;html2canvas(c).then(function(e){var n=e.toDataURL("image/png");return console.log(n),n})}}catch(e){o=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(o)throw r}}}}else(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new Promise(function(n,t){var o=document.createElement("script");o.type="text/javascript",o.src=e,document.querySelector("head").appendChild(o),o.onload=function(){n(window.html2canvas)},o.onerror=function(){t("js加载失败")}})})("//unpkg.com/html2canvas@1.0.0-alpha.12/dist/html2canvas.min.js").then(function(e){if(n.length&&(e||window.html2canvas)){var t=!0,o=!1,r=void 0;try{for(var i,a=n[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){e(i.value).then(function(e){var n=e.toDataURL("image/png");return console.log(n),n})}}catch(e){o=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(o)throw r}}}}).catch(function(e){console.log(e)})}}},{key:"initCaptureClick",value:function(){var e=this;e.captureclick&&(e.capturedDoms=[],window.addEventListener("click",function(n){var t=Array.from(n.path);if(t.pop(),t.pop(),e.capturedDoms.length>=10&&e.capturedDoms.pop(),1===e.capturemode)t[0];var o=1===e.capturemode?t[0]:t[t.length-1];e.capturedDoms.unshift(o)},!0))}},{key:"initUnhandledPromiseRejection",value:function(){this.unhandledrejection&&window.addEventListener("unhandledrejection",function(e){console.log(e)})}},{key:"initNetWork",value:function(){if(this.network&&window.XMLHttpRequest){var e=window.XMLHttpRequest,n=e.prototype.send,t=function(e){e&&e.currentTarget&&200!==e.currentTarget.status&&console.log(e)};if(e.prototype.send=function(){if(this.addEventListener)this.addEventListener("error",t),this.addEventListener("load",t),this.addEventListener("abort",t),this.addEventListener("close",t);else{var e=this.onreadystatechange;this.onreadystatechange=function(n){4===this.readyState&&t(n),e&&e.apply(this,arguments)}}return n.apply(this,arguments)},window.fetch){var o=window.fetch;window.fetch=function(){return o.apply(this,arguments).then(function(e){return e.ok||console.log(e),e}).catch(function(e){console.log(e)})}}}}},{key:"initPerference",value:function(){this.performance&&window.performance&&window.performance.getEntries()&&window.performance.getEntries().forEach(function(e){console.log(JSON.stringify(e))})}}])&&o(n.prototype,t),r&&o(n,r),e}()}])});