!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.FeMonitor=n():e.FeMonitor=n()}(window,function(){return function(e){var n={};function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=n,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)o.d(t,r,function(n){return e[n]}.bind(null,r));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="",o(o.s=0)}([function(e,n,o){"use strict";function t(e,n){for(var o=0;o<n.length;o++){var t=n[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new Promise(function(n,o){var t=document.createElement("script");t.type="text/javascript",t.src=e,document.querySelector("head").appendChild(t),t.onload=function(){n()},t.onerror=function(){o("js加载失败")}})}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(window.LZString&&LZString.compress){var n=!0,o=!1,t=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var c=i.value;html2canvas(c).then(function(e){var n=e.toDataURL("image/png"),o=LZString.compress(n);return console.log(o),o})}}catch(e){o=!0,t=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw t}}}else r("//unpkg.com/lz-string@1.4.4/libs/lz-string.js").then(function(){var n=!0,o=!1,t=void 0;try{for(var r,i=e[Symbol.iterator]();!(n=(r=i.next()).done);n=!0){var a=r.value;html2canvas(a).then(function(e){var n=e.toDataURL("image/png"),o=LZString.compress(n);return console.log(o),o})}}catch(e){o=!0,t=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw t}}})}o.r(n),o.d(n,"FeMonitor",function(){return a});var a=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e);var o=n.consolelog,t=void 0!==o&&o,r=n.consoleinfo,i=void 0!==r&&r,a=n.consoleerror,c=void 0===a||a,l=n.error,s=void 0===l||l,u=n.errormode,f=void 0===u?1:u,p=n.captureclick,d=void 0!==p&&p,v=n.capturemode,h=void 0===v?1:v,g=n.capturereportnum,m=void 0===g?1:g,w=n.unhandledrejection,y=void 0===w||w,b=n.network,k=void 0===b||b,j=n.performance,L=void 0===j||j,E=n.browser,P=void 0===E||E;this.consolelog=t,this.consoleinfo=i,this.consoleerror=c,this.error=s,this.errormode=f,this.captureclick=d,this.capturemode=h,this.capturereportnum=m,this.performance=L,this.unhandledrejection=y,this.network=k,this.browser=P,this.start()}var n,o,a;return n=e,(o=[{key:"start",value:function(){this.initConsole(),this.initError(),this.initCaptureClick(),this.initUnhandledPromiseRejection(),this.initNetWork(),this.initPerference(),this.initBrowserInfo()}},{key:"initConsole",value:function(){var e=this;e.consolelog&&e.initConsoleLog(),e.consoleinfo&&e.initConsoleInfo(),e.consoleerror&&e.initConsoleError()}},{key:"initConsoleLog",value:function(){var e={apply:function(e,n,o){return alert("我要进行上报console.log"),Reflect.apply.apply(Reflect,arguments)}};console.log=new Proxy(console.log,e)}},{key:"initConsoleInfo",value:function(){var e={apply:function(e,n,o){return alert("我要进行上报console.info"),Reflect.apply.apply(Reflect,arguments)}};console.info=new Proxy(console.info,e)}},{key:"initConsoleError",value:function(){var e={apply:function(e,n,o){return alert("我要进行上报console.error"),Reflect.apply.apply(Reflect,arguments)}};console.error=new Proxy(console.error,e)}},{key:"initError",value:function(){var e=this;if(e.error)if(1===e.errormode){var n=window.onerror;window.onerror=function(e,o,t,r,i){console.log(e,o,t,r,i),n&&n()}}else window.addEventListener("error",function(n){console.log(n);var o=n.message,t=n.filename,r=n.lineno,i=n.colno,a=n.error;console.log(o,t,r,i,a),e.reportCaptureImage()})}},{key:"reportCaptureImage",value:function(){var e=this;if(e.captureclick){e.capturereportnum=e.capturereportnum>10?10:e.capturereportnum,e.capturereportnum=e.capturereportnum<=0?1:e.capturereportnum;var n=e.capturedDoms.slice(0,e.capturereportnum)||[];window.html2canvas?n.length&&(html2canvas||window.html2canvas)&&i(n):r("//unpkg.com/html2canvas@1.0.0-alpha.12/dist/html2canvas.min.js").then(function(){n.length&&window.html2canvas&&i(n)}).catch(function(e){console.log(e)})}}},{key:"initCaptureClick",value:function(){var e=this;e.captureclick&&(e.capturedDoms=[],window.addEventListener("click",function(n){var o=Array.from(n.path);if(o.pop(),o.pop(),e.capturedDoms.length>=10&&e.capturedDoms.pop(),1===e.capturemode)o[0];var t=1===e.capturemode?o[0]:o[o.length-1];e.capturedDoms.unshift(t)},!0))}},{key:"initUnhandledPromiseRejection",value:function(){this.unhandledrejection&&window.addEventListener("unhandledrejection",function(e){console.log(e)})}},{key:"initNetWork",value:function(){if(this.network&&window.XMLHttpRequest){var e=window.XMLHttpRequest,n=e.prototype.send,o=function(e){e&&e.currentTarget&&200!==e.currentTarget.status&&console.log(e)};if(e.prototype.send=function(){if(this.addEventListener)this.addEventListener("error",o),this.addEventListener("load",o),this.addEventListener("abort",o),this.addEventListener("close",o);else{var e=this.onreadystatechange;this.onreadystatechange=function(n){4===this.readyState&&o(n),e&&e.apply(this,arguments)}}return n.apply(this,arguments)},window.fetch){var t=window.fetch;window.fetch=function(){return t.apply(this,arguments).then(function(e){return e.ok||console.log(e),e}).catch(function(e){console.log(e)})}}}}},{key:"initPerference",value:function(){this.performance&&window.performance&&window.performance.getEntries()&&window.performance.getEntries().forEach(function(e){console.log(JSON.stringify(e))})}},{key:"initBrowserInfo",value:function(){if(console.log(this.browser),this.browser)if(window.bowser&&window.bowser.getParser){var e=bowser.getParser(window.navigator.userAgent);console.log(e.parse())}else r("//unpkg.com/bowser@2.0.0-beta.3/bundled.js").then(function(){var e=bowser.getParser(window.navigator.userAgent);console.log(e.parse())}).catch(function(e){console.log(e)})}}])&&t(n.prototype,o),a&&t(n,a),e}()}])});